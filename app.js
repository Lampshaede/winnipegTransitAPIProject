const APIKey="36DdV7a4Ka1tyr8VyrGz",defaultURL="https://api.winnipegtransit.com/v3/",searchType={street:"streets:",streetStops:"stops",schedule:"stops/"},streetsList=document.querySelector(".streets"),parameters="&usage=long",getQuery=async(e,t)=>{let r=e,s="",a="";t===searchType.schedule&&(s="/schedule"),t===searchType.streetStops&&(a=`street=${e}`,r="");const n=await fetch(`${defaultURL}${t}${r}${s}.json?${a}&api-key=${APIKey}${parameters}`);t=await n.json();if(200!==n.status)throw new Error(`Status ${n.status}`);return t},renderSidebar=function(e){if(clearSidebar(),console.dir(e),0!==e.length)for(var t of e)addResultToSidebar(t);else streetsList.insertAdjacentHTML("afterbegin","<span>Sorry, no results<span>")},clearSidebar=function(){let e=streetsList.firstElementChild;for(;e;)streetsList.removeChild(e),e=streetsList.firstElementChild},addResultToSidebar=function(e){streetID=e.key,street=e.name,streetsList.insertAdjacentHTML("afterbegin",`<a href="#" data-street-key="${streetID}">${street}</a>`)},renderContent=function(){};document.querySelector("input").addEventListener("keydown",function(e){"Enter"!==e.code&&"NumpadEnter"!==e.code||(e.preventDefault(),data=getQuery(e.target.value,searchType.street),data.then(e=>{renderSidebar(e.streets),console.log(e)}))}),document.querySelector("section.streets").addEventListener("click",function(e){e=e.target.getAttribute("data-street-key");null!==e&&(data=getQuery(e,searchType.streetStops),data.then(e=>{console.log(e)}))});